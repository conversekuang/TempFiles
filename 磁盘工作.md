

### 磁盘工作介绍与其影响

之前在看linux中有讲到磁盘相关的结构与工作，但是总是没搞得十分清楚，也不知道有什么具体的用处。在看mysql中磁盘存储与数据页的时候又出现了磁盘的随机读取，elasticsearch的时候也出现了。就很好奇为什么这样的操作会更耗时？感觉需要从磁盘工作原理进行学习一哈。



#### 磁盘组成

磁盘分为：磁盘面/磁头（Heads），柱面/磁道（Cylinders），扇区( sector)。

磁盘定位扇区是通过以上三个参数来计算出扇区的所在位置。

硬盘中一般会有多个盘片组成，**每个盘片包含两个面**，**每个盘面都对应地有一个读/写磁头**。盘片的编号自下向上从0开始，如最下边的盘片有0面和1面，再上一个盘片就编号为2面和3面。

<img src = "https://upload-images.jianshu.io/upload_images/2843224-46fb935cd31addbd.png" style="zoom:60%">

下图显示的是一个盘面，**盘面中一圈圈灰色同心圆为一条条磁道**，从圆心向外画直线，可以将磁道划分为若干个弧段，每个磁道上一个弧段被称之为一个扇区（图践绿色部分）。扇区是磁盘的最小组成单元，通常是512字节。（由于不断提高磁盘的大小，部分厂商设定每个扇区的大小是4096字节）

<img src = "https://i.loli.net/2019/07/12/5d27fa3f146a730610.png" style="zoom:60%">

硬盘通常由重叠的一组盘片构成，每个盘面都被划分为数目相等的磁道，并从外缘的“0”开始编号，**具有相同编号的磁道形成一个圆柱**，称之为磁盘的柱面。磁盘的柱面数与一个盘面上的磁道数是相等的。由于每个盘面都有自己的磁头，因此，盘面数等于总的磁头数。 如下图

<img src = "https://upload-images.jianshu.io/upload_images/2843224-e0854f19c817c83c.png" style="zoom:60%">

#### 

#### 扇区、块/簇、page的关系

1. 扇区： 硬盘的最小读写单元
2. 块/簇： 是操作系统针对硬盘读写的最小单元
3. page： 是内存与操作系统之间操作的最小单元。

扇区 <= 块/簇 <= page





​	磁盘**按照柱面进行读写**。当从第1个磁道的0扇区开始写，直到写完整个磁道。然后换磁头到下一个盘面的1磁道继续写。以此类推。



#### 数据库加载数据

**数据库对数据的访问不是以行为单位的，无论读取一行还是多行，都是将该行所在的页全部记载到内存中，然后在读取对应的数据记录**





参考博客：

<https://www.jianshu.com/p/9aa66f634ed6>  磁盘工作原理



<https://www.jianshu.com/p/443e6b07f5e4>  数据库从磁盘读取文件